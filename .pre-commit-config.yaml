# ABOUTME: Pre-commit configuration for dotfiles repository
# ABOUTME: Includes Nix flake validation, shell script, YAML and Markdown linting

# Pre-commit hooks configuration for comprehensive code quality checks
# See https://pre-commit.com for more information
# See https://pre-commit.com/hooks.html for more hooks

repos:
  # ============================================================================
  # Nix-specific hooks (local repository)
  # ============================================================================
  - repo: local
    hooks:
      # Nix flake structure and syntax validation
      - id: nix-flake-check
        name: Nix Flake Check
        entry: nix flake check --all-systems --no-build
        language: system
        files: ^.*\\.nix$
        pass_filenames: false
        
  # ============================================================================
  # File-specific linting hooks
  # ============================================================================
  - repo: local
    hooks:
      # Shell script analysis with shellcheck
      - id: shellcheck
        name: ShellCheck
        entry: shellcheck
        language: system
        files: \.(sh|bash|zsh)$
        exclude: modules/shared/config/p10k\.zsh$
        args: [--external-sources, --exclude=SC1091]
        
      # Additional shellcheck for scripts/ directory (executable files)
      - id: shellcheck-scripts
        name: ShellCheck (scripts/)
        entry: shellcheck
        language: system
        files: ^scripts/[^/]*$
        exclude: \.txt$
        args: [--external-sources, --exclude=SC1091, --severity=error]
        
      # YAML file validation with yamllint
      - id: yamllint
        name: yamllint
        entry: yamllint
        language: system
        files: \.(yaml|yml)$
        args: [-d, "{extends: relaxed, rules: {line-length: {max: 120}, trailing-spaces: disable, new-line-at-end-of-file: disable}}"]
  
  # ============================================================================
  # General file quality hooks (to be added)  
  # ============================================================================
  # General file formatting and quality checks will be added here
