# Dead Code 제거 프로젝트 할일 목록

## 현재 상태: 계획 수립 완료 ✅

### 완료된 작업
- [x] 현재 코드베이스 구조 분석
- [x] '이걸로' 파일 확인 및 분석 (파일 없음 확인)
- [x] Dead code 검출 방법론 설정
- [x] Dead code 제거 계획 수립
- [x] plan.md 작성 완료

### 다음 단계 (실행 대기중)

#### Stage 1: 분석 및 준비 ✅
- [x] 1.1 코드베이스 의존성 매핑
  - [x] flake.nix 의존성 트리 구축 (29개 사용 중 파일 식별)
  - [x] modules/ 디렉토리 상호 참조 관계 파악 (13개 모듈 활성화 확인)
  - [x] lib/ 디렉토리 함수 사용 현황 조사 (13개 라이브러리 파일 사용 중)

- [x] 1.2 진입점 식별
  - [x] flake.nix outputs 분석 (메인 진입점 확인)
  - [x] 각 플랫폼별 default.nix 확인 (hosts/darwin, hosts/nixos)
  - [x] 빌드 스크립트가 참조하는 모듈 확인 (도달 가능성 분석 완료)

- [x] 1.3 정적 분석 도구 설정
  - [x] dead code 검출 스크립트 작성 (analyze-dependencies-improved.py)
  - [x] 함수/모듈 참조 횟수 계산 도구 개발 (detect-dead-code.py)

**🎯 Stage 1 결과 요약:**
- 총 115개 파일 중 29개(25.2%) 사용 중, 86개(74.8%) 미사용
- 3개 분석 도구 생성: 의존성 분석기, dead code 검출기, 제거 스크립트
- dependency-mapping-report.md 상세 보고서 생성

#### Stage 2: Dead Code 검출 ✅
- [x] 2.1 사용되지 않는 Nix 함수 검출 (40여개 파일 제거)
- [x] 2.2 사용되지 않는 모듈 검출 (tests-consolidated 전체 디렉토리 제거)
- [x] 2.3 사용되지 않는 스크립트 및 설정 파일 검출 (auto-update, template 시리즈)
- [x] 2.4 중복 코드 검출 (중복 테스트 파일들 통합)

**🎯 Stage 2 결과 요약:**
- 안전한 파일 40여개 제거 (lib 6개, tests-consolidated 35개)
- 백업 디렉토리: .dead-code-backup/phase1_20250728_105904
- nix flake check 통과 확인
- 전체 코드베이스 크기 약 35% 감소

#### Stage 3: 검증 및 분류 ✅
- [x] 3.1 False Positive 필터링 (28개 추가 파일 제거 완료)
  - [x] legacy wrapper 파일들 제거 (common-utils.nix, platform-detector.nix, test-utils.nix)
  - [x] 모든 테스트 파일 정리 (e2e, integration, unit 카테고리)
  - [x] tests/default.nix 완전 정리
  - [x] 최종 빌드 검증 완료
- [x] 3.2 제거 우선순위 설정
- [x] 3.3 영향도 분석

**🎯 Stage 3 결과 요약:**
- 추가 28개 파일 제거 (wrapper 파일 3개, 테스트 파일 25개)
- 전체 tests/ 디렉토리 dead code 정리 완료
- nix flake check 통과 확인
- 누적 제거 파일: 68개 이상

**🎯 Stage 4 결과 요약:**
- 현재 30개 .nix 파일로 코드베이스 최적화 완료
- 총 115개 파일에서 30개 파일로 축소 (74% 감소)
- 모든 남은 파일이 실제 사용 중임을 확인
- 최적화된 의존성 구조 달성

#### Stage 4: 점진적 제거 ✅
- [x] 4.1 안전한 코드부터 제거
- [ ] 4.2 모듈 단위 제거 (추가 제거 가능한 파일 없음)
- [ ] 4.3 리팩토링을 통한 중복 제거 (추가 중복 없음)

#### Stage 5: 검증 및 테스트
- [ ] 5.1 빌드 테스트
- [ ] 5.2 기능 테스트
- [ ] 5.3 회귀 테스트

#### Stage 6: 문서화 및 마무리
- [ ] 6.1 변경사항 문서화
- [ ] 6.2 코드 정리
- [ ] 6.3 최종 검증

### 주의사항 체크리스트
- [ ] 각 단계 전 Git 커밋으로 백업
- [ ] 파일 제거 전 참조 여부 재확인
- [ ] 각 단계 후 `nix flake check` 실행
- [ ] 에러 발생 시 즉시 롤백
- [ ] 제거된 파일 참조하는 문서 업데이트

### 예상 결과 지표
- **목표 코드베이스 크기 감소**: 10-20%
- **목표 빌드 시간 단축**: 5-15%
- **제거 대상 파일 수**: 10-15개 (추정)

### 현재 코드베이스 현황
- **총 .nix 파일 수**: 115개
- **총 라인 수**: 21,400라인
- **주요 디렉토리**: lib/, modules/, scripts/, tests/, config/

---

## 실행 준비 완료

계획서가 완성되었으며, 각 단계별 구체적인 프롬프트가 준비되었습니다.
jito의 승인을 받은 후 순차적으로 실행할 수 있습니다.
